<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />

        <!-- Mobile -->
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- CSS -->
        <link rel="stylesheet" href="/theme.css">
        <style>
            /* Outfit Latin */
            @font-face {
                font-family: 'Outfit';
                font-style: normal;
                font-weight: 100 900;
                font-display: swap;
                src: url(https://fonts.gstatic.com/s/outfit/v14/QGYvz_MVcBeNP4NJtEtqUYTkntBJ.woff2) format('woff2');
                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
            }
        </style>

        <!-- Source Sans 3 -->
        <link rel="preload" href="https://fonts.gstatic.com/s/sourcesans3/v18/nwpStKy2OAdR1K-IwhWudF-R3w8aZejZ5HZV8Q.woff2"
            as="font" crossorigin="anonymous">

        <!-- Preconnect -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

        <!-- Preload -->
        <link rel="preload" href="/assets/background_tile_half.png" as="image">

        <!-- Animation Continuity -->
        <script>
            const elapsed = Date.now() % 240000;
            document.documentElement.style.setProperty('--animation-delay', `-${elapsed}ms`);
        </script>
    </head>

    <body style="background-color: #171b1f; color: #ffffff; overflow-x: hidden; width: 100vw; margin: 0; padding: 0; font-family: 'Source Sans 3', sans-serif;">
        <div class="hero" id="hero">
            <div class="hero-background"></div>
            <div class="hero-main">
                <div class="hero-container">
                    <h1><small id="title">Loading...</small></h1>
                    <h2 id="subtitle">Checking for Updates...</h2>
                </div>
            </div>
        </div>
        <section class="simple" style="display: none" id="instructions">
            <h2>How do I update?</h2>
            <p>You can download the latest version on <a href="https://ko-fi.com/pizzablu/shop">KoFi</a>.</p>
        </section>
        <div class="footer main">
            <div class="row"></div>
        </div>

        <script type="module">
            import {TOOLS} from './tools.js';

            function update_message(title, subtitle) {
                document.getElementById("title").textContent = title;
                document.getElementById("subtitle").textContent = subtitle;
            }

            function check() {
                const params = new URLSearchParams(location.search);
                const id = params.get("id");
                const release = params.get("release");
                const release_int = parseInt(release);
                if (!id || !release || release_int == NaN || !(id in TOOLS)) {
                    update_message("Error", "You can still check for updates manually on KoFi.");
                    console.warn('invalid tool info:', id, release);
                }
                if (TOOLS[id].release == release_int) {
                    update_message("You're up to date!", `You have the latest version of ${TOOLS[id].name}.`);
                } else {
                    update_message("Update Available!", `You can upgrade ${TOOLS[id].name} to version ${TOOLS[id].version}.`);
                    document.getElementById("instructions").style.display = "block";
                }
            }

            document.addEventListener("DOMContentLoaded", () => {
                setTimeout(check, 100);
            });
        </script>

        <!-- Google Analytics -->
        <script defer async src="https://www.googletagmanager.com/gtag/js?id=G-PJX6P9P9GV" fetchpriority="low"></script>
        <script defer>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-PJX6P9P9GV');
        </script>
    </body>
</html>